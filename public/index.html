<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.faceit.com/oauth/faceit-oauth-sdk-1.3.0.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var initParams = {
            client_id: "075a09a2-3155-47b1-8b9b-62f6de5f7bf1",
            response_type: "code",
            redirect_popup: true,
            state: "..."
        };

        function callback(code) {
            if (code) {
                // Send the code to our server
                fetch('/auth/callback?code=' + encodeURIComponent(code))
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Authentication failed');
                        }
                        return response.text();
                    })
                    .then(html => {
                        // Replace the current page content with the success message
                        document.documentElement.innerHTML = html;
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('Authentication failed. Please try again.');
                    });
            } else {
                alert("The id token is not valid, something went wrong");
            }
        }

        FACEIT.init(initParams, callback);
    </script>
</head>
<body>
    <div id="faceitLogin"></div>
</body>
</html>
